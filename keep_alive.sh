#!/bin/bash

# ç¡®ä¿è®¾ç½®äº†ä»£ç† (å‚è€ƒä½ çš„ ClashX è®¾ç½®)
export HTTP_PROXY=http://127.0.0.1:54935
export HTTPS_PROXY=http://127.0.0.1:54935

# ç¼–è¯‘ç¨‹åº (æ¯” go run æ›´ç¨³å®š)
echo "æ­£åœ¨ç¼–è¯‘..."
go build -o simple_ai_trader_bin .
if [ $? -ne 0 ]; then
    echo "ç¼–è¯‘å¤±è´¥ï¼Œè¯·æ£€æŸ¥ä»£ç é”™è¯¯"
    exit 1
fi

echo "âœ… ç¼–è¯‘æˆåŠŸï¼Œå‡†å¤‡å¯åŠ¨ 7*24 å°æ—¶å®ˆæŠ¤è¿›ç¨‹..."
echo "æç¤º: ä½¿ç”¨ Ctrl+C å¯ä»¥åœæ­¢å¾ªç¯"

# å¾ªç¯å¯åŠ¨
while true; do
    echo "----------------------------------------"
    echo "ğŸš€ æ­£åœ¨å¯åŠ¨äº¤æ˜“ç¨‹åº: $(date)"
    echo "----------------------------------------"
    
    # è¿è¡Œç¨‹åºï¼Œå¹¶å°†æ—¥å¿—åŒæ—¶è¾“å‡ºåˆ°å±å¹•å’Œæ–‡ä»¶
    ./simple_ai_trader_bin | tee -a trader.log
    
    echo "âš ï¸ ç¨‹åºå¼‚å¸¸é€€å‡º (Exit Code: $?). 5ç§’åé‡å¯..."
    sleep 5
done
